<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Registration sso</title>
  <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>
<body style="background:black">
  <!-- navbar -->
    <div class="navbar" style="height: 70px">
      <nav class="black">
        <div class="container">
        <div class="nav-wrapper">
            <a href="#!" class="brand-logo black-text">
              <img src="assets/Nameguild.png" style="width: 270px">
            </a> 
            <a href="#" data-target="mobile-nav" class="sidenav-trigger"><i class="material-icons">menu</i></a>
            <ul class="right hide-on-med-and-down navtext">              
                  <li><a href="">Login</a></li>
                  <li><a href="homeadmin.html">Home Admin</a></li>
                  <li><a href="homecivilian.html">Home Civilian</a></li>              
            </ul>
        </div>
        </div>          
      </nav>
    </div>
  <!-- mobile nav -->
  <ul class="sidenav" id="mobile-nav">    
        <li><a href="">Login</a></li>
        <li><a href="homeadmin.html">Home Admin</a></li>
        <li><a href="homecivilian.html">Home Civilian</a></li>
  </ul>
  
  <!-- Form -->
  <div class="container">
    <div class="card white" style="border: 5px solid orange; border-radius: 20px">
      <div class="card-content">
        <div class="card-title orange-text center-align">Registration</div>
        <div class="input-field">
            <input value="" id="username" type="text" class="validate" required>
            <label for="username">Username</label>
        </div>
        <div style="margin-top: -15px;">
            <div class="row" style="margin: 0;">
                <div class="col s7 m9" style="padding: 0; height: 70px;">
                    <div class="input-field">
                        <input onkeyup="checkStrengthPwd()" placeholder="Password" id="password" type="password" required>
                        <label for="password">Password</label>
                        <!-- <span class="password-msg" data-error="wrong" data-success="right"></span> -->
                    </div>
                </div>
                <div class="col s5 m3" style="padding: 0;">
                    <i onclick="showPwd(1)" id="vis" class="material-icons vertical-middle" style="cursor: pointer; margin-top: 20px;">visibility_off</i>
                    <span onclick="generatePwd()" class="btn vertical-middle font-hp orange" style="margin-top: 20px; margin-left: 5px; padding: 0px 8px;">Generate</span>
                </div>
            </div>
            <span class="password-msg" data-error="wrong" data-success="right"></span>
        </div>
        <div class="row" style="margin: 0;">
            <div class="col s7 m9" style="padding: 0; height: 70px;">
                <div class="input-field">
                    <input onkeyup="checkMatchPwd()" placeholder="Confirm Password" id="password2" type="password" required>
                    <label for="password2">Confirm Password</label>
                </div>
            </div>
            <div class="col s5 m3" style="padding: 0;">
                <i onclick="showPwd(2)" id="vis2" class="material-icons" style="cursor: pointer; margin-top: 30px;">visibility_off</i>
            </div>
        </div>
        <span class="password2-msg" data-error="wrong" data-success="right"></span>
        <!-- <div class="input-field">
            <input value="" id="password2" type="password" class="validate" required>
            <label for="password2">Confirm Password</label>
        </div> -->
        <div class="input-field">
            <input placeholder="Full Name" value="" id="full_name" type="text" class="validate">
            <label for="full_name">Full Name</label>
        </div>
        <div class="input-field">
            <input placeholder="31882137271405587" value="" id="nik" type="number" class="validate" required>
            <label for="nik">NIK</label>
        </div>
        <div class="file-field input-field">
            <div class="btn orange">
              <span>Upload KTP</span>
              <input type="file" id="ktp" required>
            </div>
            <div class="file-path-wrapper">
              <input class="file-path validate" type="text" value="Choose a file" required>
            </div>
        </div>
        <div class="input-field">
            <input value="" id="address" type="text" class="validate" required>
            <label for="address">Address</label>
        </div>
        <div style="margin-top: -10px; margin-bottom: -10px;">
            <div class="row">
                <div class="col s6">
                    <label>Member Type</label>
                    <select id="member-type" name="member-type" class="browser-default">
                        <option value="Civilian" selected>Civilian</option>
                        <option value="Guild Member">Guild Member</option>
                        <option value="Manager">Manager</option>
                    </select>
                </div>
                <div class="col s6">
                    <label>Join Period</label>
                    <select id="join-period" name="join-period" class="browser-default">
                        <option value="1" selected>1 Month</option>
                        <option value="3">3 Months</option>
                        <option value="6">6 Months</option>
                        <option value="12">12 Months</option>
                    </select>
                </div>
            </div>
        </div>
        <div style="margin-bottom: -20px;">
            <div class="row" style="padding: 0;">
                <div class="col s6">
                    <div class="input-field" style="margin-bottom: 0px;">
                        <input onkeyup="checkPhone(1)" placeholder="+628139847255" id="phone" type="text" style="margin-top: 5px;" required>
                        <label for="phone">Handphone Number</label>
                    </div>
                    <span class="phone-msg" data-error="wrong" data-success="right"></span>
                </div>
                <div class="col s6">
                    <div class="input-field" style="margin-bottom: 0px;">
                        <input onkeyup="checkPhone(2)" placeholder="+628139847255" id="phone2" type="text" style="margin-top: 5px;">
                        <label for="phone2">Telephone Number (Optional)</label>
                    </div>
                    <span class="phone2-msg" data-error="wrong" data-success="right"></span>
                </div>
            </div>
        </div>
        <div class="input-field" style="margin-top: 35px;">
            <input value="" id="profession" type="text" class="validate" required>
            <label for="profession">Profession</label>
        </div>
        <div class="input-field">
            <textarea id="skillset" class="materialize-textarea" required></textarea>
            <label for="skillset">Skillset</label>
        </div>
        <div class="input-field">
            <input id="birthdate" value="" type="text" class="datepicker" required>
            <label for="birthdate">Birthdate</label>
        </div>
        
        <div style="text-align: center;"><button type="submit" class="btn orange" onclick="checkInput(event)">Register</button></div>
      </div>
    </div>      
  </div>
    

  <!-- footer -->    
  <div class="footer-copyright orange center-align" style="height: 50px">
    <div class="container valign-wrapper" style="height: 90%; text-align: center">
      <p style="font-size: 20px">Â© 2020 Copyright Chamaleon Guild</p>            
    </div>
  </div>


  <!--JavaScript at end of body for optimized loading-->
      <script type="text/javascript" src="js/materialize.min.js"></script>
      <script>
        document.addEventListener('DOMContentLoaded', function() {
        var elems = document.querySelectorAll('.datepicker');
        var instances = M.Datepicker.init(elems, {});

        var elems2 = document.querySelectorAll('.modal');
        var instances2 = M.Modal.init(elems2, {});

        var elems3 = document.querySelectorAll('.sidenav');
        var instances3 = M.Sidenav.init(elems3, {});

        var name = sessionStorage.getItem("name");
        if (name){
            var fullname = document.querySelector('#full_name');
            fullname.setAttribute('value',name);
        }
        });

        function checkStrengthPwd(){
            var pwd = document.querySelector('#password');
            var msg = document.querySelector('.password-msg');
            var regex = /^[A-Za-z0-9]+$/;
            if (pwd.value.length < 6){
                msg.innerHTML = '<span style="color: red;">Password is too short!</span>';
                pwd.classList.remove("valid");
                pwd.classList.add("invalid");
            } else if (pwd.value === pwd.value.toLowerCase() || pwd.value.match(regex)) {
                msg.innerHTML = '<span style="color: red;">Password should contain at least 1 upper case alphabet, numeric, and special character.</span>';
                pwd.classList.remove("valid");
                pwd.classList.add("invalid");
            } else {
                checkMatchPwd();
                msg.innerHTML = '';
                pwd.classList.remove("invalid");
                pwd.classList.add("valid");
            }
        }

        function checkMatchPwd(){
            var pwd = document.querySelector('#password');
            var pwd2 = document.querySelector('#password2');
            var msg = document.querySelector('.password2-msg');
            if (pwd.value != pwd2.value){
                msg.innerHTML = '<span style="color: red;">Password not match!</span>';
                pwd2.classList.remove("valid");
                pwd2.classList.add("invalid");
            } else {
                msg.innerHTML = '';
                pwd2.classList.remove("invalid");
                pwd2.classList.add("valid");
            }
        }

        function generatePassword() {
            var length = 10,
                charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+{}:,./'<>?",
                retVal = "";
            for (var i = 0, n = charset.length; i < length; ++i) {
                retVal += charset.charAt(Math.floor(Math.random() * n));
            }
            return retVal;
        }

        function showPwd(n){
            if (n == 1){
                var pwd = document.querySelector('#password');
                var vis = document.querySelector('#vis');
            } else if (n == 2){
                var pwd = document.querySelector('#password2');
                var vis = document.querySelector('#vis2');
            }
            pwd.setAttribute('type', 'text');
            vis.textContent = 'visibility';
            vis.setAttribute('onclick', 'hidePwd('+n+')');
        }

        function hidePwd(n){
            if (n == 1){
                var pwd = document.querySelector('#password');
                var vis = document.querySelector('#vis');
            } else if (n == 2){
                var pwd = document.querySelector('#password2');
                var vis = document.querySelector('#vis2');
            }
            pwd.setAttribute('type', 'password');
            vis.textContent = 'visibility_off';
            vis.setAttribute('onclick', 'showPwd('+n+')');
        }

        function generatePwd(){
            var pwd = document.querySelector('#password');
            pwd.value = '';
            pwd.value = generatePassword();
            showPwd(1);
        }

        function checkPhone(n){
            if (n == 1){
                var selectphone = document.querySelector('#phone')
                var phone = selectphone.value;
                var msg = document.querySelector('.phone-msg');
            } else if (n == 2){
                var selectphone = document.querySelector('#phone2')
                var phone = selectphone.value;
                var msg = document.querySelector('.phone2-msg');
            }
            if (phone.match(/^\+[1-9]{1}[0-9]{3,14}$/)){
                msg.innerHTML = '';
                selectphone.classList.remove("invalid");
                selectphone.classList.add("valid");
            } else {
                msg.innerHTML = '<span style="color: red;">Phone number should contain country and area code.</span>';
                selectphone.classList.remove("valid");
                selectphone.classList.add("invalid");
            }
        }

        function checkInput(event){
            var input = document.querySelectorAll("input");
            var error = false;
            input.forEach(function(item, index, list){
                if (item.classList.contains("invalid") || item.value == ""){
                    if (item.id != "phone2"){
                        error = true;
                    }
                }
            });
            if(error){
                event.preventDefault();
                alert("Registration error. Make sure your information is valid!");
                
            } else {
                var datauname = document.querySelector("#username").value;
                var dataname = document.querySelector("#full_name").value;
                var datanik = document.querySelector("#nik").value;
                var dataaddress = document.querySelector("#address").value;
                var selecttype = document.querySelector("#member-type");
                var datatype = selecttype.options[selecttype.selectedIndex].value;
                var dataphone = document.querySelector("#phone").value;

                sessionStorage.setItem("username", datauname);
                sessionStorage.setItem("full-name", dataname);
                sessionStorage.setItem("nik", datanik);
                sessionStorage.setItem("address", dataaddress);
                sessionStorage.setItem("type-member", datatype);
                sessionStorage.setItem("handphone", dataphone);

                window.location.href = "homecivilian.html";
            }
        }
      </script>
</body>
</html>